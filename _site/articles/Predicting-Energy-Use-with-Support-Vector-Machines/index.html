<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Starting In On Some Machine Learning &#8211; The Training Set</title>
<meta name="description" content="Using a machine learning algorithm for predicting next-hour electricity consumption.">
<meta name="keywords" content="machine-learning, smart-meters, predictive-analytics, electricity, demand-side, support-vector-machine">


<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Starting In On Some Machine Learning">
<meta property="og:description" content="Using a machine learning algorithm for predicting next-hour electricity consumption.">
<meta property="og:url" content="http://localhost:4000/articles/Predicting-Energy-Use-with-Support-Vector-Machines">
<meta property="og:site_name" content="The Training Set">





<link rel="canonical" href="http://localhost:4000/articles/Predicting-Energy-Use-with-Support-Vector-Machines">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="The Training Set Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Google Webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>
<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.min.css">

<!--[if (lt IE 9) & (!IEMobile)]>
<link rel="stylesheet" href="http://localhost:4000/assets/css/ie.min.css">
<![endif]-->

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://localhost:4000/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="article" itemscope itemtype="http://schema.org/WebPage">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="http://localhost:4000">The Training Set</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" itemscope itemtype="http://schema.org/SiteNavigationElement">
		    <ul>
		        
				<li><a href="http://localhost:4000/about/" >About</a></li>
		        
				<li><a href="http://localhost:4000/articles/" >Articles</a></li>
		        
				<li><a href="http://localhost:4000/body-of-work/" >Body of Work</a></li>
		        
		        <li><i class="icon-feed"></i> <a href="http://localhost:4000/feed.xml" title="Atom/RSS feed">Feed</a>
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->

<div class="image-wrap">
  <img src="http://localhost:4000/images/texture-feature-05.jpg" alt="Starting In On Some Machine Learning feature image" itemprop="primaryImageOfPage">
  <span class="image-credit">Photo Credit: <a href="http://texturelovers.com">Texture Lovers</a></span>
</div><!-- /.image-wrap -->

<div id="main" role="main" itemprop="mainContentOfPage" itemscope itemtype="http://schema.org/Blog">
  <div class="article-author-side">
    <img src="http://localhost:4000/images/bio-photo.jpg" class="bio-photo" alt="Justin Elszasz bio photo"></a>
<h3>Justin Elszasz</h3>
<p>Engineering background, indeterminate foreground.</p>

<a href="http://facebook.com/jtelszasz" class="author-social" target="_blank"><i class="icon-facebook"></i> Facebook</a>

<a href="http://linkedin.com/in/justinelszasz" class="author-social" target="_blank"><i class="icon-linkedin"></i> LinkedIn</a>

<a href="http://github.com/jtelszasz" class="author-social" target="_blank"><i class="icon-github"></i> Github</a>


  </div>
  <article itemscope itemtype="http://schema.org/BlogPosting" itemprop="blogPost">
    <div class="headline-wrap">
      <h1 itemprop="name">Starting In On Some Machine Learning</h1>
      <h2></h2>
    </div><!--/ .headline-wrap -->
    <div class="article-wrap" itemprop="text">
      <section id="table-of-contents" class="toc">
  <header>
    <h3>Contents</h3>
  </header>
<div id="drawer">
<ul id="markdown-toc">
  <li><a href="#i-thought-we-had-a-model">I Thought We Had a Model</a></li>
  <li><a href="#enter-machine-learning">Enter Machine Learning</a></li>
  <li><a href="#statistical-model">Statistical Model</a></li>
  <li><a href="#engineering-model">Engineering Model</a></li>
</ul>

  </div>
</section>
<!-- /#table-of-contents -->

<p>As part of my research in grad school I had started getting interested in the use of machine learning tools for predicting energy consumption.  I went so far as to enroll in a machine learning class, but lacking the some of the statistical/mathematical knowledge for what they were teaching I ended up dropping about three-quarters of the way through.  I’ve since gone back on my own time and learned more statisical inference through online coursework, and am taking a stab at some analysis and coding.</p>

<h2 id="i-thought-we-had-a-model">I Thought We Had a Model</h2>

<p>In <a href="http://localhost:4000/articles/Energy-Use-and-Weather/">another post</a> I plotted electricity consumption against outdoor temperature and fit a straight line to the data.  </p>

<figure>
  <a href="http://localhost:4000/images/Elec_and_Temp_OLS.png"><img src="http://localhost:4000/images/Elec_and_Temp_OLS.png" /></a>
  <figcaption>Linear ordinary least squares regression model for electricity consumption using outdoor temperature.</figcaption>
</figure>

<p>Let’s be honest: in terms of predictive capacity, this model sucks.  What if I needed to predict what the electricity consumption would be in the next hour?  The prediction would be on the line - I measure what the outdoor temperature is and read off the corresponding consumption from the blue line.  But look at how far the actual usage is scattered.  Unless I got very lucky, I’d be way off.  (In fact, using Bayesian regression I could quantify that probability, but that’s for another post.)</p>

<p>Clearly the underlying linear physics, the heat transfer equation below, doesn’t tell the whole story.  It doesn’t capture other aspects of the weather (wind and sun) and human behavior that all influence the amount of electricity consumed.  </p>

<p><img src="http://latex.codecogs.com/png.latex?Q = hA \Delta T" alt="Q = hA \Delta T" /></p>

<h2 id="enter-machine-learning">Enter Machine Learning</h2>

<p>Certainly there are other simpler modeling approaches I can take, and I’d like to learn more about those as well.  But because Python and Scikit-learn have made it so easy and intuitive, I jumped straight into the deep end with support vector machines.  Support vector machines find an <em>optimal</em> decision surface or regression model for the training data provided while trying to minimize the complexity of the model (to prevent overfitting).</p>

<h2 id="statistical-model">Statistical Model</h2>

<p>To take a first crack at quantifying the relationship we can use an ordinary least squares regression to try and quantify that relationship.  As is typically the case with Python, someone has already coded the tools necessary so I just have to import the Statsmodels module and use the right tool.</p>

<p>Running the following block of code…</p>

<div class="highlight"><pre><code class="python"><span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">elec_and_weather</span><span class="p">[</span><span class="s">&#39;USAGE&#39;</span><span class="p">],</span><span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">elec_and_weather</span><span class="p">[</span><span class="s">&#39;tempF&#39;</span><span class="p">]))</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="k">print</span> <span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div>

<p>…fits the model to our data and spits out the information about the model.</p>

<figure>
  <a href="http://localhost:4000/images/Elec_and_Temp_OLS_Output.png"><img src="http://localhost:4000/images/Elec_and_Temp_OLS_Output.png" /></a>
  <figcaption>Ordinary least squares regression model.</figcaption>
</figure>

<p>This is what the model actually looks like on top of the data.</p>

<figure>
  <a href="http://localhost:4000/images/Elec_and_Temp_OLS.png"><img src="http://localhost:4000/images/Elec_and_Temp_OLS.png" /></a>
  <figcaption>Linear ordinary least squares regression model for electricity consumption using outdoor temperature.</figcaption>
</figure>

<p>So our R^2 shows that 48% of the variation in the electricity use can be explained by the outdoor temperature alone.  The remaining 52% would have to be explained by other variables or natural variability.</p>

<h1 id="engineering-model">Engineering Model</h1>

<p>What are we saying by assuming that the model should be linear?  That (all else being equal) for every degree increase in the outdoor temperature, there should be a proportional decrease in the electricity consumption.  There’s a reason this is a valid assumption, again negelecting the otherwise stochastic behavior as a result of weather and occupancy/behavior.  The underlying heat transfer equation is:</p>

<p><img src="http://latex.codecogs.com/png.latex?Q = hA \Delta T" alt="Q = hA \Delta T" /></p>

<ul>
  <li>where <img src="http://latex.codecogs.com/png.latex?\inline Q" alt="Q" /> is a heat flow rate</li>
  <li><img src="http://latex.codecogs.com/png.latex?\inline h" alt="h" /> is a characteristic heat transfer coefficient</li>
  <li><img src="http://latex.codecogs.com/png.latex?\inline A" alt="A" /> is the perpendicular area through which heat is passing</li>
  <li>and <img src="http://latex.codecogs.com/png.latex?\inline \Delta T" alt="\Delta T" /> is the temperature difference across the boundary through which heat is being transmitted, in this case outdoor and indoor temperature</li>
</ul>

<p>If we were to assume that the behavior in the apartment was constant - the same lights were always on, the same devices were always charging, the refrigerator compressor was always running - if we assumed that the thermostat was always set at 70 degrees, and we assumed that the only part of the weather that ever changed was the temperature (humidity and wind were constant) the linear regression model we ran earlier would exactly mirror this equation.  The variation in the electricity consumption would be entirely explained by the change in outdoor temperature, and the slope of the line would be the overall heat transfer coefficient of the apartment (through walls, windows, doors, floors, ceilings, leakage, etc.) multiplied by the square area of the apartment boundary.  By installing higher R-value insulation in the walls or replacing our old drafty windows with triple-glazing, Argon-filled windows, we’d be altering the overall heat transfer coefficient <img src="http://latex.codecogs.com/png.latex?\inline h" alt="h" /> and effectively reducing the slope of the line we fit to the data.  We can also alter the line’s slope by changing the thermostat setting; remember, the temperature difference <img src="http://latex.codecogs.com/png.latex?\inline \Delta T" alt="\Delta T" /> we’re talking about is the difference between the outdoor and indoor temperatures.</p>

<p>As in all things, there is no true black (statistics) and white (engineering) - there are only grays.  In this regard smart meters can  obviously help us learn about buildings in addition to occupancy/behavior.  With clever algorithms (not the simple linear model I’ve used above) we can start to disaggregate energy consumption into its constituent parts - building response to weather and occupancy behavior.  Indeed, we’ve begun to do this.  For example, BGE recommends different energy efficiency actions I can take based on my consumption patterns.  But this is just a first step in how these data can be used, even just at individual residence level.  I’m imagining exploring in future analyses how to use these data to size battery storage and solar photovoltaics.</p>


      <hr />
      <footer role="contentinfo">
        <div class="article-author-bottom">
          <img src="http://localhost:4000/images/bio-photo.jpg" class="bio-photo" alt="Justin Elszasz bio photo"></a>
<h3>Justin Elszasz</h3>
<p>Engineering background, indeterminate foreground.</p>

<a href="http://facebook.com/jtelszasz" class="author-social" target="_blank"><i class="icon-facebook"></i> Facebook</a>

<a href="http://linkedin.com/in/justinelszasz" class="author-social" target="_blank"><i class="icon-linkedin"></i> LinkedIn</a>

<a href="http://github.com/jtelszasz" class="author-social" target="_blank"><i class="icon-github"></i> Github</a>


        </div>
        <p class="byline"><strong>Starting In On Some Machine Learning</strong> was published on <time datetime="2014-05-10T00:00:00-04:00" itemprop="datePublished">May 10, 2014</time> and last modified on <time datetime="2014-05-10" itemprop="dateModified">May 10, 2014</time> by <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name"><a href="http://localhost:4000/about" title="About Justin Elszasz" itemprop="url">Justin Elszasz</a></span></span>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="http://localhost:4000/articles">View all articles</a>)</small></h4>
    <ul>
    
      
      
        
          
        
      
      
      <li><a href="http://localhost:4000/articles/Autocorrelation" title="Electricity Usage Autocorrelation">Electricity Usage Autocorrelation</a></li>
      
    
      
      
        
          
        
      
      
      <li><a href="http://localhost:4000/articles/Energy-Use-and-Weather" title="Energy Use and Weather">Energy Use and Weather</a></li>
      
    
      
      
        
          
        
      
      
      <li><a href="http://localhost:4000/articles/More-Smart-Meter-Data" title="More Smart Meter Data...">More Smart Meter Data...</a></li>
      
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  <footer>
    <span>&copy; 2014 Justin Elszasz. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://localhost:4000/assets/js/scripts.min.js"></script>
	        

</body>
</html>
